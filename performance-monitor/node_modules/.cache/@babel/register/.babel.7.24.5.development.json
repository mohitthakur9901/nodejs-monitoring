{"{\"assumptions\":{},\"sourceRoot\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"filename\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.5:development":{"value":{"code":"console.log(\"hello\");\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9tb2hpdC9EZXNrdG9wL25vZGVqcy1tb25pdG9yaW5nL3BlcmZvcm1hbmNlLW1vbml0b3Ivc3JjLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc29sZS5sb2coXCJoZWxsb1wiKTsiXSwibWFwcGluZ3MiOiJBQUFBQSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxPQUFPLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["console","log"],"sourceRoot":"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/","sources":["index.js"],"sourcesContent":["console.log(\"hello\");"],"mappings":"AAAAA,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC","ignoreList":[]}},"mtime":1714910917804},"{\"assumptions\":{},\"sourceRoot\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"filename\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-decorators\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"VariableDeclarator\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"ClassPrivateProperty\":{\"enter\":[null]},\"ClassAccessorProperty\":{\"enter\":[null]},\"ClassProperty\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"version\":\"2021-12\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]}],\"presets\":[]}:7.24.5:development":{"value":{"code":"var _Server;\nlet _initStatic;\nfunction old_createMetadataMethodsForProperty(e, t, a, r) { return { getMetadata: function (o) { old_assertNotFinished(r, \"getMetadata\"), old_assertMetadataKey(o); var i = e[o]; if (void 0 !== i) if (1 === t) { var n = i.public; if (void 0 !== n) return n[a]; } else if (2 === t) { var l = i.private; if (void 0 !== l) return l.get(a); } else if (Object.hasOwnProperty.call(i, \"constructor\")) return i.constructor; }, setMetadata: function (o, i) { old_assertNotFinished(r, \"setMetadata\"), old_assertMetadataKey(o); var n = e[o]; if (void 0 === n && (n = e[o] = {}), 1 === t) { var l = n.public; void 0 === l && (l = n.public = {}), l[a] = i; } else if (2 === t) { var s = n.priv; void 0 === s && (s = n.private = new Map()), s.set(a, i); } else n.constructor = i; } }; }\nfunction old_convertMetadataMapToFinal(e, t) { var a = e[Symbol.metadata || Symbol.for(\"Symbol.metadata\")], r = Object.getOwnPropertySymbols(t); if (0 !== r.length) { for (var o = 0; o < r.length; o++) { var i = r[o], n = t[i], l = a ? a[i] : null, s = n.public, c = l ? l.public : null; s && c && Object.setPrototypeOf(s, c); var d = n.private; if (d) { var u = Array.from(d.values()), f = l ? l.private : null; f && (u = u.concat(f)), n.private = u; } l && Object.setPrototypeOf(n, l); } a && Object.setPrototypeOf(t, a), e[Symbol.metadata || Symbol.for(\"Symbol.metadata\")] = t; } }\nfunction old_createAddInitializerMethod(e, t) { return function (a) { old_assertNotFinished(t, \"addInitializer\"), old_assertCallable(a, \"An initializer\"), e.push(a); }; }\nfunction old_memberDec(e, t, a, r, o, i, n, l, s) { var c; switch (i) { case 1: c = \"accessor\"; break; case 2: c = \"method\"; break; case 3: c = \"getter\"; break; case 4: c = \"setter\"; break; default: c = \"field\"; } var d, u, f = { kind: c, name: l ? \"#\" + t : _toPropertyKey(t), isStatic: n, isPrivate: l }, p = { v: !1 }; if (0 !== i && (f.addInitializer = old_createAddInitializerMethod(o, p)), l) { d = 2, u = Symbol(t); var v = {}; 0 === i ? (v.get = a.get, v.set = a.set) : 2 === i ? v.get = function () { return a.value; } : (1 !== i && 3 !== i || (v.get = function () { return a.get.call(this); }), 1 !== i && 4 !== i || (v.set = function (e) { a.set.call(this, e); })), f.access = v; } else d = 1, u = t; try { return e(s, Object.assign(f, old_createMetadataMethodsForProperty(r, d, u, p))); } finally { p.v = !0; } }\nfunction old_assertNotFinished(e, t) { if (e.v) throw Error(\"attempted to call \" + t + \" after decoration was finished\"); }\nfunction old_assertMetadataKey(e) { if (\"symbol\" != typeof e) throw new TypeError(\"Metadata keys must be symbols, received: \" + e); }\nfunction old_assertCallable(e, t) { if (\"function\" != typeof e) throw new TypeError(t + \" must be a function\"); }\nfunction old_assertValidReturnValue(e, t) { var a = typeof t; if (1 === e) { if (\"object\" !== a || null === t) throw new TypeError(\"accessor decorators must return an object with get, set, or init properties or void 0\"); void 0 !== t.get && old_assertCallable(t.get, \"accessor.get\"), void 0 !== t.set && old_assertCallable(t.set, \"accessor.set\"), void 0 !== t.init && old_assertCallable(t.init, \"accessor.init\"), void 0 !== t.initializer && old_assertCallable(t.initializer, \"accessor.initializer\"); } else if (\"function\" !== a) throw new TypeError((0 === e ? \"field\" : 10 === e ? \"class\" : \"method\") + \" decorators must return a function or void 0\"); }\nfunction old_getInit(e) { var t; return null == (t = e.init) && (t = e.initializer) && void 0 !== console && console.warn(\".initializer has been renamed to .init as of March 2022\"), t; }\nfunction old_applyMemberDec(e, t, a, r, o, i, n, l, s) { var c, d, u, f, p, v, y, h = a[0]; if (n ? (0 === o || 1 === o ? (c = { get: a[3], set: a[4] }, u = \"get\") : 3 === o ? (c = { get: a[3] }, u = \"get\") : 4 === o ? (c = { set: a[3] }, u = \"set\") : c = { value: a[3] }, 0 !== o && (1 === o && _setFunctionName(a[4], \"#\" + r, \"set\"), _setFunctionName(a[3], \"#\" + r, u))) : 0 !== o && (c = Object.getOwnPropertyDescriptor(t, r)), 1 === o ? f = { get: c.get, set: c.set } : 2 === o ? f = c.value : 3 === o ? f = c.get : 4 === o && (f = c.set), \"function\" == typeof h) void 0 !== (p = old_memberDec(h, r, c, l, s, o, i, n, f)) && (old_assertValidReturnValue(o, p), 0 === o ? d = p : 1 === o ? (d = old_getInit(p), v = p.get || f.get, y = p.set || f.set, f = { get: v, set: y }) : f = p);else for (var m = h.length - 1; m >= 0; m--) { var b; void 0 !== (p = old_memberDec(h[m], r, c, l, s, o, i, n, f)) && (old_assertValidReturnValue(o, p), 0 === o ? b = p : 1 === o ? (b = old_getInit(p), v = p.get || f.get, y = p.set || f.set, f = { get: v, set: y }) : f = p, void 0 !== b && (void 0 === d ? d = b : \"function\" == typeof d ? d = [d, b] : d.push(b))); } if (0 === o || 1 === o) { if (void 0 === d) d = function (e, t) { return t; };else if (\"function\" != typeof d) { var g = d; d = function (e, t) { for (var a = t, r = 0; r < g.length; r++) a = g[r].call(e, a); return a; }; } else { var _ = d; d = function (e, t) { return _.call(e, t); }; } e.push(d); } 0 !== o && (1 === o ? (c.get = f.get, c.set = f.set) : 2 === o ? c.value = f : 3 === o ? c.get = f : 4 === o && (c.set = f), n ? 1 === o ? (e.push(function (e, t) { return f.get.call(e, t); }), e.push(function (e, t) { return f.set.call(e, t); })) : 2 === o ? e.push(f) : e.push(function (e, t) { return f.call(e, t); }) : Object.defineProperty(t, r, c)); }\nfunction old_applyMemberDecs(e, t, a, r, o) { for (var i, n, l = new Map(), s = new Map(), c = 0; c < o.length; c++) { var d = o[c]; if (Array.isArray(d)) { var u, f, p, v = d[1], y = d[2], h = d.length > 3, m = v >= 5; if (m ? (u = t, f = r, 0 != (v -= 5) && (p = n = n || [])) : (u = t.prototype, f = a, 0 !== v && (p = i = i || [])), 0 !== v && !h) { var b = m ? s : l, g = b.get(y) || 0; if (!0 === g || 3 === g && 4 !== v || 4 === g && 3 !== v) throw Error(\"Attempted to decorate a public method/accessor that has the same name as a previously decorated public method/accessor. This is not currently supported by the decorators plugin. Property name was: \" + y); !g && v > 2 ? b.set(y, v) : b.set(y, !0); } old_applyMemberDec(e, u, d, y, v, m, h, f, p); } } old_pushInitializers(e, i), old_pushInitializers(e, n); }\nfunction old_pushInitializers(e, t) { t && e.push(function (e) { for (var a = 0; a < t.length; a++) t[a].call(e); return e; }); }\nfunction old_applyClassDecs(e, t, a, r) { if (r.length > 0) { for (var o = [], i = t, n = t.name, l = r.length - 1; l >= 0; l--) { var s = { v: !1 }; try { var c = Object.assign({ kind: \"class\", name: n, addInitializer: old_createAddInitializerMethod(o, s) }, old_createMetadataMethodsForProperty(a, 0, n, s)), d = r[l](i, c); } finally { s.v = !0; } void 0 !== d && (old_assertValidReturnValue(10, d), i = d); } e.push(i, function () { for (var e = 0; e < o.length; e++) o[e].call(i); }); } }\nfunction _applyDecs(e, t, a) { var r = [], o = {}, i = {}; return old_applyMemberDecs(r, e, i, o, t), old_convertMetadataMapToFinal(e.prototype, i), old_applyClassDecs(r, e, o, a), old_convertMetadataMapToFinal(e, o), r; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _setFunctionName(e, t, n) { \"symbol\" == typeof t && (t = (t = t.description) ? \"[\" + t + \"]\" : \"\"); try { Object.defineProperty(e, \"name\", { configurable: !0, value: n ? n + \" \" + t : t }); } catch (e) {} return e; }\nconst {\n  once\n} = require(\"events\");\nconst {\n  createServer\n} = require(\"http\");\nconst {\n  randomUUID\n} = require(\"crypto\");\nconst {\n  route,\n  responseTimeTracker\n} = require(\"./decorator\");\nconst {\n  setTimeout\n} = require(\"timers/promises\");\nconst Db = new Map();\nclass Server {\n  static async handler(request, response) {\n    await setTimeout(parseInt(Math.random() * 100));\n    if (request.method === \"POST\") {\n      const data = await once(request, \"data\");\n      const item = JSON.parse(data);\n      item.id = randomUUID();\n      Db.set(item.id, item);\n      return {\n        statusCode: 201,\n        message: item\n      };\n    }\n    return {\n      statusCode: 200,\n      message: [...Db.values()]\n    };\n  }\n}\n_Server = Server;\n(() => {\n  [_initStatic] = _applyDecs(_Server, [[[responseTimeTracker, route], 7, \"handler\"]], []);\n  _initStatic(_Server);\n})();\ncreateServer(Server.handler).listen(3000, () => console.log(\"server is running at 3000\"));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvbmNlIiwicmVxdWlyZSIsImNyZWF0ZVNlcnZlciIsInJhbmRvbVVVSUQiLCJyb3V0ZSIsInJlc3BvbnNlVGltZVRyYWNrZXIiLCJzZXRUaW1lb3V0IiwiRGIiLCJNYXAiLCJTZXJ2ZXIiLCJoYW5kbGVyIiwicmVxdWVzdCIsInJlc3BvbnNlIiwicGFyc2VJbnQiLCJNYXRoIiwicmFuZG9tIiwibWV0aG9kIiwiZGF0YSIsIml0ZW0iLCJKU09OIiwicGFyc2UiLCJpZCIsInNldCIsInN0YXR1c0NvZGUiLCJtZXNzYWdlIiwidmFsdWVzIiwiX1NlcnZlciIsIl9pbml0U3RhdGljIiwiX2FwcGx5RGVjcyIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciXSwic291cmNlUm9vdCI6Ii9ob21lL21vaGl0L0Rlc2t0b3Avbm9kZWpzLW1vbml0b3JpbmcvcGVyZm9ybWFuY2UtbW9uaXRvci9zcmMvIiwic291cmNlcyI6WyJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IG9uY2UgfSA9IHJlcXVpcmUoXCJldmVudHNcIik7XG5jb25zdCB7IGNyZWF0ZVNlcnZlciB9ID0gcmVxdWlyZShcImh0dHBcIik7XG5jb25zdCB7IHJhbmRvbVVVSUQgfSA9IHJlcXVpcmUoXCJjcnlwdG9cIik7XG5jb25zdCB7IHJvdXRlLCByZXNwb25zZVRpbWVUcmFja2VyIH0gPSByZXF1aXJlKFwiLi9kZWNvcmF0b3JcIik7XG5jb25zdCB7IHNldFRpbWVvdXQgfSA9IHJlcXVpcmUoXCJ0aW1lcnMvcHJvbWlzZXNcIik7XG5jb25zdCBEYiA9IG5ldyBNYXAoKTtcbmNsYXNzIFNlcnZlciB7XG4gIEByZXNwb25zZVRpbWVUcmFja2VyXG4gIEByb3V0ZSAvLyBtdXN0IGJlIGZpcnN0IGJlY2F1c2UgaXQgY2hhbmdlcyB0aGUgcmVzcG9uc2UgZGF0YVxuICBzdGF0aWMgYXN5bmMgaGFuZGxlcihyZXF1ZXN0LCByZXNwb25zZSkge1xuICAgIGF3YWl0IHNldFRpbWVvdXQocGFyc2VJbnQoTWF0aC5yYW5kb20oKSAqIDEwMCkpO1xuXG4gICAgaWYgKHJlcXVlc3QubWV0aG9kID09PSBcIlBPU1RcIikge1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IG9uY2UocmVxdWVzdCwgXCJkYXRhXCIpO1xuICAgICAgY29uc3QgaXRlbSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICBpdGVtLmlkID0gcmFuZG9tVVVJRCgpO1xuXG4gICAgICBEYi5zZXQoaXRlbS5pZCwgaXRlbSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGF0dXNDb2RlOiAyMDEsXG4gICAgICAgIG1lc3NhZ2U6IGl0ZW0sXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzQ29kZTogMjAwLFxuICAgICAgbWVzc2FnZTogWy4uLkRiLnZhbHVlcygpXSxcbiAgICB9O1xuICB9XG59XG5cbmNyZWF0ZVNlcnZlcihTZXJ2ZXIuaGFuZGxlcikubGlzdGVuKDMwMDAsICgpID0+XG4gIGNvbnNvbGUubG9nKFwic2VydmVyIGlzIHJ1bm5pbmcgYXQgMzAwMFwiKVxuKTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLE1BQU07RUFBRUE7QUFBSyxDQUFDLEdBQUdDLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDbEMsTUFBTTtFQUFFQztBQUFhLENBQUMsR0FBR0QsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUN4QyxNQUFNO0VBQUVFO0FBQVcsQ0FBQyxHQUFHRixPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ3hDLE1BQU07RUFBRUcsS0FBSztFQUFFQztBQUFvQixDQUFDLEdBQUdKLE9BQU8sQ0FBQyxhQUFhLENBQUM7QUFDN0QsTUFBTTtFQUFFSztBQUFXLENBQUMsR0FBR0wsT0FBTyxDQUFDLGlCQUFpQixDQUFDO0FBQ2pELE1BQU1NLEVBQUUsR0FBRyxJQUFJQyxHQUFHLENBQUMsQ0FBQztBQUNwQixNQUFNQyxNQUFNLENBQUM7RUFDWCxhQUVhQyxPQUFPQSxDQUFDQyxPQUFPLEVBQUVDLFFBQVEsRUFBRTtJQUN0QyxNQUFNTixVQUFVLENBQUNPLFFBQVEsQ0FBQ0MsSUFBSSxDQUFDQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDO0lBRS9DLElBQUlKLE9BQU8sQ0FBQ0ssTUFBTSxLQUFLLE1BQU0sRUFBRTtNQUM3QixNQUFNQyxJQUFJLEdBQUcsTUFBTWpCLElBQUksQ0FBQ1csT0FBTyxFQUFFLE1BQU0sQ0FBQztNQUN4QyxNQUFNTyxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDSCxJQUFJLENBQUM7TUFDN0JDLElBQUksQ0FBQ0csRUFBRSxHQUFHbEIsVUFBVSxDQUFDLENBQUM7TUFFdEJJLEVBQUUsQ0FBQ2UsR0FBRyxDQUFDSixJQUFJLENBQUNHLEVBQUUsRUFBRUgsSUFBSSxDQUFDO01BQ3JCLE9BQU87UUFDTEssVUFBVSxFQUFFLEdBQUc7UUFDZkMsT0FBTyxFQUFFTjtNQUNYLENBQUM7SUFDSDtJQUNBLE9BQU87TUFDTEssVUFBVSxFQUFFLEdBQUc7TUFDZkMsT0FBTyxFQUFFLENBQUMsR0FBR2pCLEVBQUUsQ0FBQ2tCLE1BQU0sQ0FBQyxDQUFDO0lBQzFCLENBQUM7RUFDSDtBQUNGO0FBQUNDLE9BQUEsR0F0QktqQixNQUFNO0FBQUE7RUFBQSxDQUFBa0IsV0FBQSxJQUFBQyxVQUFBLENBQUFGLE9BQUEsS0FDVHJCLG1CQUFtQixFQUNuQkQsS0FBSztFQUFBdUIsV0FBQSxDQUFBRCxPQUFBO0FBQUE7QUFzQlJ4QixZQUFZLENBQUNPLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDLENBQUNtQixNQUFNLENBQUMsSUFBSSxFQUFFLE1BQ3hDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQywyQkFBMkIsQ0FDekMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["once","require","createServer","randomUUID","route","responseTimeTracker","setTimeout","Db","Map","Server","handler","request","response","parseInt","Math","random","method","data","item","JSON","parse","id","set","statusCode","message","values","_Server","_initStatic","_applyDecs","listen","console","log"],"sourceRoot":"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/","sources":["index.js"],"sourcesContent":["const { once } = require(\"events\");\nconst { createServer } = require(\"http\");\nconst { randomUUID } = require(\"crypto\");\nconst { route, responseTimeTracker } = require(\"./decorator\");\nconst { setTimeout } = require(\"timers/promises\");\nconst Db = new Map();\nclass Server {\n  @responseTimeTracker\n  @route // must be first because it changes the response data\n  static async handler(request, response) {\n    await setTimeout(parseInt(Math.random() * 100));\n\n    if (request.method === \"POST\") {\n      const data = await once(request, \"data\");\n      const item = JSON.parse(data);\n      item.id = randomUUID();\n\n      Db.set(item.id, item);\n      return {\n        statusCode: 201,\n        message: item,\n      };\n    }\n    return {\n      statusCode: 200,\n      message: [...Db.values()],\n    };\n  }\n}\n\ncreateServer(Server.handler).listen(3000, () =>\n  console.log(\"server is running at 3000\")\n);\n"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,MAAM;EAAEA;AAAK,CAAC,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAClC,MAAM;EAAEC;AAAa,CAAC,GAAGD,OAAO,CAAC,MAAM,CAAC;AACxC,MAAM;EAAEE;AAAW,CAAC,GAAGF,OAAO,CAAC,QAAQ,CAAC;AACxC,MAAM;EAAEG,KAAK;EAAEC;AAAoB,CAAC,GAAGJ,OAAO,CAAC,aAAa,CAAC;AAC7D,MAAM;EAAEK;AAAW,CAAC,GAAGL,OAAO,CAAC,iBAAiB,CAAC;AACjD,MAAMM,EAAE,GAAG,IAAIC,GAAG,CAAC,CAAC;AACpB,MAAMC,MAAM,CAAC;EACX,aAEaC,OAAOA,CAACC,OAAO,EAAEC,QAAQ,EAAE;IACtC,MAAMN,UAAU,CAACO,QAAQ,CAACC,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;IAE/C,IAAIJ,OAAO,CAACK,MAAM,KAAK,MAAM,EAAE;MAC7B,MAAMC,IAAI,GAAG,MAAMjB,IAAI,CAACW,OAAO,EAAE,MAAM,CAAC;MACxC,MAAMO,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC;MAC7BC,IAAI,CAACG,EAAE,GAAGlB,UAAU,CAAC,CAAC;MAEtBI,EAAE,CAACe,GAAG,CAACJ,IAAI,CAACG,EAAE,EAAEH,IAAI,CAAC;MACrB,OAAO;QACLK,UAAU,EAAE,GAAG;QACfC,OAAO,EAAEN;MACX,CAAC;IACH;IACA,OAAO;MACLK,UAAU,EAAE,GAAG;MACfC,OAAO,EAAE,CAAC,GAAGjB,EAAE,CAACkB,MAAM,CAAC,CAAC;IAC1B,CAAC;EACH;AACF;AAACC,OAAA,GAtBKjB,MAAM;AAAA;EAAA,CAAAkB,WAAA,IAAAC,UAAA,CAAAF,OAAA,KACTrB,mBAAmB,EACnBD,KAAK;EAAAuB,WAAA,CAAAD,OAAA;AAAA;AAsBRxB,YAAY,CAACO,MAAM,CAACC,OAAO,CAAC,CAACmB,MAAM,CAAC,IAAI,EAAE,MACxCC,OAAO,CAACC,GAAG,CAAC,2BAA2B,CACzC,CAAC","ignoreList":[]}},"mtime":1714913673243},"{\"assumptions\":{},\"sourceRoot\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"filename\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/decorator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-decorators\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"VariableDeclarator\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"ClassPrivateProperty\":{\"enter\":[null]},\"ClassAccessorProperty\":{\"enter\":[null]},\"ClassProperty\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"version\":\"2021-12\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{},\"externalDependencies\":[]}],\"presets\":[]}:7.24.5:development":{"value":{"code":"const {\n  randomUUID\n} = require('crypto');\nfunction route(target, {\n  kind,\n  name\n}) {\n  if (kind !== 'method') return target;\n  return async function (request, response) {\n    const {\n      statusCode,\n      message\n    } = await target.apply(this, [request, response]);\n    response.writeHead(statusCode);\n    response.end(JSON.stringify(message));\n  };\n}\nconst isUiDisabled = process.env.UI_DISABLED;\nlet ui;\nif (isUiDisabled) {\n  ui = {\n    updateGraph: () => {}\n  };\n} else {\n  const Ui = require('./ui');\n  ui = new Ui();\n}\nconst log = (...args) => {\n  if (isUiDisabled) console.log(...args);\n};\nfunction responseTimeTracker(target, {\n  kind,\n  name\n}) {\n  if (kind !== 'method') return target;\n  return function (request, response) {\n    const reqId = randomUUID();\n    const requestStartedAt = performance.now();\n    const methodsTimeTracker = {\n      GET: performance.now(),\n      POST: performance.now()\n    };\n    // console.time('benchmark')\n    const afterExecution = target.apply(this, [request, response]);\n    const data = {\n      reqId,\n      name,\n      method: request.method,\n      url: request.url\n    };\n\n    // afterExecution.finally(_ => {\n    //   console.timeEnd('benchmark')\n    // })\n    const onFinally = onRequestEnded({\n      data,\n      response,\n      requestStartedAt,\n      methodsTimeTracker\n    });\n\n    // assuming it'll always be a promise object\n    afterExecution.finally(onFinally);\n    return afterExecution;\n  };\n}\nfunction onRequestEnded({\n  data,\n  response,\n  requestStartedAt,\n  methodsTimeTracker\n}) {\n  return () => {\n    const requestEndedAt = performance.now();\n    let timeDiff = requestEndedAt - requestStartedAt;\n    let seconds = Math.round(timeDiff);\n    data.statusCode = response.statusCode;\n    data.statusMessage = response.statusMessage;\n    data.elapsed = timeDiff.toFixed(2).concat('ms');\n    log('benchmark', data);\n    //  simulationg that we already made some calculations or spawned the process in another one\n    const trackerDiff = requestEndedAt - methodsTimeTracker[data.method];\n    if (trackerDiff >= 200) {\n      ui.updateGraph(data.method, seconds);\n      methodsTimeTracker[data.method] = performance.now();\n    }\n  };\n}\nmodule.exports = {\n  route,\n  responseTimeTracker\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyYW5kb21VVUlEIiwicmVxdWlyZSIsInJvdXRlIiwidGFyZ2V0Iiwia2luZCIsIm5hbWUiLCJyZXF1ZXN0IiwicmVzcG9uc2UiLCJzdGF0dXNDb2RlIiwibWVzc2FnZSIsImFwcGx5Iiwid3JpdGVIZWFkIiwiZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsImlzVWlEaXNhYmxlZCIsInByb2Nlc3MiLCJlbnYiLCJVSV9ESVNBQkxFRCIsInVpIiwidXBkYXRlR3JhcGgiLCJVaSIsImxvZyIsImFyZ3MiLCJjb25zb2xlIiwicmVzcG9uc2VUaW1lVHJhY2tlciIsInJlcUlkIiwicmVxdWVzdFN0YXJ0ZWRBdCIsInBlcmZvcm1hbmNlIiwibm93IiwibWV0aG9kc1RpbWVUcmFja2VyIiwiR0VUIiwiUE9TVCIsImFmdGVyRXhlY3V0aW9uIiwiZGF0YSIsIm1ldGhvZCIsInVybCIsIm9uRmluYWxseSIsIm9uUmVxdWVzdEVuZGVkIiwiZmluYWxseSIsInJlcXVlc3RFbmRlZEF0IiwidGltZURpZmYiLCJzZWNvbmRzIiwiTWF0aCIsInJvdW5kIiwic3RhdHVzTWVzc2FnZSIsImVsYXBzZWQiLCJ0b0ZpeGVkIiwiY29uY2F0IiwidHJhY2tlckRpZmYiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9tb2hpdC9EZXNrdG9wL25vZGVqcy1tb25pdG9yaW5nL3BlcmZvcm1hbmNlLW1vbml0b3Ivc3JjLyIsInNvdXJjZXMiOlsiZGVjb3JhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHtcbiAgICByYW5kb21VVUlEXG4gIH0gPSByZXF1aXJlKCdjcnlwdG8nKVxuICBcbiAgZnVuY3Rpb24gcm91dGUodGFyZ2V0LCB7XG4gICAga2luZCxcbiAgICBuYW1lXG4gIH0pIHtcbiAgICBpZiAoa2luZCAhPT0gJ21ldGhvZCcpIHJldHVybiB0YXJnZXQ7XG4gIFxuICAgIHJldHVybiBhc3luYyBmdW5jdGlvbiAocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgc3RhdHVzQ29kZSxcbiAgICAgICAgbWVzc2FnZVxuICAgICAgfSA9IGF3YWl0IHRhcmdldC5hcHBseSh0aGlzLCBbcmVxdWVzdCwgcmVzcG9uc2VdKVxuICBcbiAgICAgIHJlc3BvbnNlLndyaXRlSGVhZChzdGF0dXNDb2RlKVxuICAgICAgcmVzcG9uc2UuZW5kKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpKVxuICAgIH1cbiAgfVxuICBjb25zdCBpc1VpRGlzYWJsZWQgPSBwcm9jZXNzLmVudi5VSV9ESVNBQkxFRFxuICBsZXQgdWlcbiAgaWYgKGlzVWlEaXNhYmxlZCkge1xuICAgIHVpID0ge1xuICAgICAgdXBkYXRlR3JhcGg6ICgpID0+IHt9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IFVpID0gcmVxdWlyZSgnLi91aScpXG4gICAgdWkgPSBuZXcgVWkoKVxuICB9XG4gIFxuICBjb25zdCBsb2cgPSAoLi4uYXJncykgPT4ge1xuICAgIGlmIChpc1VpRGlzYWJsZWQpIGNvbnNvbGUubG9nKC4uLmFyZ3MpXG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHJlc3BvbnNlVGltZVRyYWNrZXIodGFyZ2V0LCB7XG4gICAga2luZCxcbiAgICBuYW1lXG4gIH0pIHtcbiAgICBpZiAoa2luZCAhPT0gJ21ldGhvZCcpIHJldHVybiB0YXJnZXQ7XG4gIFxuICAgIHJldHVybiBmdW5jdGlvbiAocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICAgIGNvbnN0IHJlcUlkID0gcmFuZG9tVVVJRCgpXG4gICAgICBjb25zdCByZXF1ZXN0U3RhcnRlZEF0ID0gcGVyZm9ybWFuY2Uubm93KClcbiAgICAgIGNvbnN0IG1ldGhvZHNUaW1lVHJhY2tlciA9IHtcbiAgICAgICAgR0VUOiBwZXJmb3JtYW5jZS5ub3coKSxcbiAgICAgICAgUE9TVDogcGVyZm9ybWFuY2Uubm93KCksXG4gICAgICB9XG4gICAgICAvLyBjb25zb2xlLnRpbWUoJ2JlbmNobWFyaycpXG4gICAgICBjb25zdCBhZnRlckV4ZWN1dGlvbiA9IHRhcmdldC5hcHBseSh0aGlzLCBbcmVxdWVzdCwgcmVzcG9uc2VdKVxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgcmVxSWQsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIG1ldGhvZDogcmVxdWVzdC5tZXRob2QsXG4gICAgICAgIHVybDogcmVxdWVzdC51cmxcbiAgICAgIH1cbiAgXG4gICAgICAvLyBhZnRlckV4ZWN1dGlvbi5maW5hbGx5KF8gPT4ge1xuICAgICAgLy8gICBjb25zb2xlLnRpbWVFbmQoJ2JlbmNobWFyaycpXG4gICAgICAvLyB9KVxuICAgICAgY29uc3Qgb25GaW5hbGx5ID0gb25SZXF1ZXN0RW5kZWQoe1xuICAgICAgICBkYXRhLFxuICAgICAgICByZXNwb25zZSxcbiAgICAgICAgcmVxdWVzdFN0YXJ0ZWRBdCxcbiAgICAgICAgbWV0aG9kc1RpbWVUcmFja2VyXG4gICAgICB9KVxuICBcbiAgICAgIC8vIGFzc3VtaW5nIGl0J2xsIGFsd2F5cyBiZSBhIHByb21pc2Ugb2JqZWN0XG4gICAgICBhZnRlckV4ZWN1dGlvbi5maW5hbGx5KG9uRmluYWxseSlcbiAgICAgIHJldHVybiBhZnRlckV4ZWN1dGlvblxuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gb25SZXF1ZXN0RW5kZWQoe1xuICAgIGRhdGEsXG4gICAgcmVzcG9uc2UsXG4gICAgcmVxdWVzdFN0YXJ0ZWRBdCxcbiAgICBtZXRob2RzVGltZVRyYWNrZXJcbiAgfSkge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0RW5kZWRBdCA9IHBlcmZvcm1hbmNlLm5vdygpXG4gICAgICBsZXQgdGltZURpZmYgPSByZXF1ZXN0RW5kZWRBdCAtIHJlcXVlc3RTdGFydGVkQXRcbiAgICAgIGxldCBzZWNvbmRzID0gTWF0aC5yb3VuZCh0aW1lRGlmZilcbiAgXG4gICAgICBkYXRhLnN0YXR1c0NvZGUgPSByZXNwb25zZS5zdGF0dXNDb2RlXG4gICAgICBkYXRhLnN0YXR1c01lc3NhZ2UgPSByZXNwb25zZS5zdGF0dXNNZXNzYWdlXG4gICAgICBkYXRhLmVsYXBzZWQgPSB0aW1lRGlmZi50b0ZpeGVkKDIpLmNvbmNhdCgnbXMnKVxuICAgICAgbG9nKCdiZW5jaG1hcmsnLCBkYXRhKVxuICAgICAgLy8gIHNpbXVsYXRpb25nIHRoYXQgd2UgYWxyZWFkeSBtYWRlIHNvbWUgY2FsY3VsYXRpb25zIG9yIHNwYXduZWQgdGhlIHByb2Nlc3MgaW4gYW5vdGhlciBvbmVcbiAgICAgIGNvbnN0IHRyYWNrZXJEaWZmID0gcmVxdWVzdEVuZGVkQXQgLSBtZXRob2RzVGltZVRyYWNrZXJbZGF0YS5tZXRob2RdXG4gICAgICBpZiAodHJhY2tlckRpZmYgPj0gMjAwKSB7XG4gIFxuICAgICAgICB1aS51cGRhdGVHcmFwaChcbiAgICAgICAgICBkYXRhLm1ldGhvZCxcbiAgICAgICAgICBzZWNvbmRzXG4gICAgICAgIClcbiAgICAgICAgbWV0aG9kc1RpbWVUcmFja2VyW2RhdGEubWV0aG9kXSA9IHBlcmZvcm1hbmNlLm5vdygpXG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICByb3V0ZSxcbiAgICByZXNwb25zZVRpbWVUcmFja2VyXG4gIH0iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFDRkE7QUFDRixDQUFDLEdBQUdDLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFFckIsU0FBU0MsS0FBS0EsQ0FBQ0MsTUFBTSxFQUFFO0VBQ3JCQyxJQUFJO0VBQ0pDO0FBQ0YsQ0FBQyxFQUFFO0VBQ0QsSUFBSUQsSUFBSSxLQUFLLFFBQVEsRUFBRSxPQUFPRCxNQUFNO0VBRXBDLE9BQU8sZ0JBQWdCRyxPQUFPLEVBQUVDLFFBQVEsRUFBRTtJQUN4QyxNQUFNO01BQ0pDLFVBQVU7TUFDVkM7SUFDRixDQUFDLEdBQUcsTUFBTU4sTUFBTSxDQUFDTyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUNKLE9BQU8sRUFBRUMsUUFBUSxDQUFDLENBQUM7SUFFakRBLFFBQVEsQ0FBQ0ksU0FBUyxDQUFDSCxVQUFVLENBQUM7SUFDOUJELFFBQVEsQ0FBQ0ssR0FBRyxDQUFDQyxJQUFJLENBQUNDLFNBQVMsQ0FBQ0wsT0FBTyxDQUFDLENBQUM7RUFDdkMsQ0FBQztBQUNIO0FBQ0EsTUFBTU0sWUFBWSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsV0FBVztBQUM1QyxJQUFJQyxFQUFFO0FBQ04sSUFBSUosWUFBWSxFQUFFO0VBQ2hCSSxFQUFFLEdBQUc7SUFDSEMsV0FBVyxFQUFFQSxDQUFBLEtBQU0sQ0FBQztFQUN0QixDQUFDO0FBQ0gsQ0FBQyxNQUFNO0VBQ0wsTUFBTUMsRUFBRSxHQUFHcEIsT0FBTyxDQUFDLE1BQU0sQ0FBQztFQUMxQmtCLEVBQUUsR0FBRyxJQUFJRSxFQUFFLENBQUMsQ0FBQztBQUNmO0FBRUEsTUFBTUMsR0FBRyxHQUFHQSxDQUFDLEdBQUdDLElBQUksS0FBSztFQUN2QixJQUFJUixZQUFZLEVBQUVTLE9BQU8sQ0FBQ0YsR0FBRyxDQUFDLEdBQUdDLElBQUksQ0FBQztBQUN4QyxDQUFDO0FBRUQsU0FBU0UsbUJBQW1CQSxDQUFDdEIsTUFBTSxFQUFFO0VBQ25DQyxJQUFJO0VBQ0pDO0FBQ0YsQ0FBQyxFQUFFO0VBQ0QsSUFBSUQsSUFBSSxLQUFLLFFBQVEsRUFBRSxPQUFPRCxNQUFNO0VBRXBDLE9BQU8sVUFBVUcsT0FBTyxFQUFFQyxRQUFRLEVBQUU7SUFDbEMsTUFBTW1CLEtBQUssR0FBRzFCLFVBQVUsQ0FBQyxDQUFDO0lBQzFCLE1BQU0yQixnQkFBZ0IsR0FBR0MsV0FBVyxDQUFDQyxHQUFHLENBQUMsQ0FBQztJQUMxQyxNQUFNQyxrQkFBa0IsR0FBRztNQUN6QkMsR0FBRyxFQUFFSCxXQUFXLENBQUNDLEdBQUcsQ0FBQyxDQUFDO01BQ3RCRyxJQUFJLEVBQUVKLFdBQVcsQ0FBQ0MsR0FBRyxDQUFDO0lBQ3hCLENBQUM7SUFDRDtJQUNBLE1BQU1JLGNBQWMsR0FBRzlCLE1BQU0sQ0FBQ08sS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDSixPQUFPLEVBQUVDLFFBQVEsQ0FBQyxDQUFDO0lBQzlELE1BQU0yQixJQUFJLEdBQUc7TUFDWFIsS0FBSztNQUNMckIsSUFBSTtNQUNKOEIsTUFBTSxFQUFFN0IsT0FBTyxDQUFDNkIsTUFBTTtNQUN0QkMsR0FBRyxFQUFFOUIsT0FBTyxDQUFDOEI7SUFDZixDQUFDOztJQUVEO0lBQ0E7SUFDQTtJQUNBLE1BQU1DLFNBQVMsR0FBR0MsY0FBYyxDQUFDO01BQy9CSixJQUFJO01BQ0ozQixRQUFRO01BQ1JvQixnQkFBZ0I7TUFDaEJHO0lBQ0YsQ0FBQyxDQUFDOztJQUVGO0lBQ0FHLGNBQWMsQ0FBQ00sT0FBTyxDQUFDRixTQUFTLENBQUM7SUFDakMsT0FBT0osY0FBYztFQUN2QixDQUFDO0FBQ0g7QUFFQSxTQUFTSyxjQUFjQSxDQUFDO0VBQ3RCSixJQUFJO0VBQ0ozQixRQUFRO0VBQ1JvQixnQkFBZ0I7RUFDaEJHO0FBQ0YsQ0FBQyxFQUFFO0VBQ0QsT0FBTyxNQUFNO0lBQ1gsTUFBTVUsY0FBYyxHQUFHWixXQUFXLENBQUNDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hDLElBQUlZLFFBQVEsR0FBR0QsY0FBYyxHQUFHYixnQkFBZ0I7SUFDaEQsSUFBSWUsT0FBTyxHQUFHQyxJQUFJLENBQUNDLEtBQUssQ0FBQ0gsUUFBUSxDQUFDO0lBRWxDUCxJQUFJLENBQUMxQixVQUFVLEdBQUdELFFBQVEsQ0FBQ0MsVUFBVTtJQUNyQzBCLElBQUksQ0FBQ1csYUFBYSxHQUFHdEMsUUFBUSxDQUFDc0MsYUFBYTtJQUMzQ1gsSUFBSSxDQUFDWSxPQUFPLEdBQUdMLFFBQVEsQ0FBQ00sT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxNQUFNLENBQUMsSUFBSSxDQUFDO0lBQy9DMUIsR0FBRyxDQUFDLFdBQVcsRUFBRVksSUFBSSxDQUFDO0lBQ3RCO0lBQ0EsTUFBTWUsV0FBVyxHQUFHVCxjQUFjLEdBQUdWLGtCQUFrQixDQUFDSSxJQUFJLENBQUNDLE1BQU0sQ0FBQztJQUNwRSxJQUFJYyxXQUFXLElBQUksR0FBRyxFQUFFO01BRXRCOUIsRUFBRSxDQUFDQyxXQUFXLENBQ1pjLElBQUksQ0FBQ0MsTUFBTSxFQUNYTyxPQUNGLENBQUM7TUFDRFosa0JBQWtCLENBQUNJLElBQUksQ0FBQ0MsTUFBTSxDQUFDLEdBQUdQLFdBQVcsQ0FBQ0MsR0FBRyxDQUFDLENBQUM7SUFDckQ7RUFDRixDQUFDO0FBQ0g7QUFFQXFCLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2ZqRCxLQUFLO0VBQ0x1QjtBQUNGLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["randomUUID","require","route","target","kind","name","request","response","statusCode","message","apply","writeHead","end","JSON","stringify","isUiDisabled","process","env","UI_DISABLED","ui","updateGraph","Ui","log","args","console","responseTimeTracker","reqId","requestStartedAt","performance","now","methodsTimeTracker","GET","POST","afterExecution","data","method","url","onFinally","onRequestEnded","finally","requestEndedAt","timeDiff","seconds","Math","round","statusMessage","elapsed","toFixed","concat","trackerDiff","module","exports"],"sourceRoot":"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/","sources":["decorator.js"],"sourcesContent":["const {\n    randomUUID\n  } = require('crypto')\n  \n  function route(target, {\n    kind,\n    name\n  }) {\n    if (kind !== 'method') return target;\n  \n    return async function (request, response) {\n      const {\n        statusCode,\n        message\n      } = await target.apply(this, [request, response])\n  \n      response.writeHead(statusCode)\n      response.end(JSON.stringify(message))\n    }\n  }\n  const isUiDisabled = process.env.UI_DISABLED\n  let ui\n  if (isUiDisabled) {\n    ui = {\n      updateGraph: () => {}\n    }\n  } else {\n    const Ui = require('./ui')\n    ui = new Ui()\n  }\n  \n  const log = (...args) => {\n    if (isUiDisabled) console.log(...args)\n  }\n  \n  function responseTimeTracker(target, {\n    kind,\n    name\n  }) {\n    if (kind !== 'method') return target;\n  \n    return function (request, response) {\n      const reqId = randomUUID()\n      const requestStartedAt = performance.now()\n      const methodsTimeTracker = {\n        GET: performance.now(),\n        POST: performance.now(),\n      }\n      // console.time('benchmark')\n      const afterExecution = target.apply(this, [request, response])\n      const data = {\n        reqId,\n        name,\n        method: request.method,\n        url: request.url\n      }\n  \n      // afterExecution.finally(_ => {\n      //   console.timeEnd('benchmark')\n      // })\n      const onFinally = onRequestEnded({\n        data,\n        response,\n        requestStartedAt,\n        methodsTimeTracker\n      })\n  \n      // assuming it'll always be a promise object\n      afterExecution.finally(onFinally)\n      return afterExecution\n    }\n  }\n  \n  function onRequestEnded({\n    data,\n    response,\n    requestStartedAt,\n    methodsTimeTracker\n  }) {\n    return () => {\n      const requestEndedAt = performance.now()\n      let timeDiff = requestEndedAt - requestStartedAt\n      let seconds = Math.round(timeDiff)\n  \n      data.statusCode = response.statusCode\n      data.statusMessage = response.statusMessage\n      data.elapsed = timeDiff.toFixed(2).concat('ms')\n      log('benchmark', data)\n      //  simulationg that we already made some calculations or spawned the process in another one\n      const trackerDiff = requestEndedAt - methodsTimeTracker[data.method]\n      if (trackerDiff >= 200) {\n  \n        ui.updateGraph(\n          data.method,\n          seconds\n        )\n        methodsTimeTracker[data.method] = performance.now()\n      }\n    }\n  }\n  \n  module.exports = {\n    route,\n    responseTimeTracker\n  }"],"mappings":"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","ignoreList":[]}},"mtime":1714913553288},"{\"assumptions\":{},\"sourceRoot\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"filename\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/decorator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-decorators\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"VariableDeclarator\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"ClassPrivateProperty\":{\"enter\":[null]},\"ClassAccessorProperty\":{\"enter\":[null]},\"ClassProperty\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"version\":\"2021-12\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]}],\"presets\":[]}:7.24.5:development":{"value":{"code":"const {\n  randomUUID\n} = require('crypto');\nfunction route(target, {\n  kind,\n  name\n}) {\n  if (kind !== 'method') return target;\n  return async function (request, response) {\n    const {\n      statusCode,\n      message\n    } = await target.apply(this, [request, response]);\n    response.writeHead(statusCode);\n    response.end(JSON.stringify(message));\n  };\n}\nconst isUiDisabled = process.env.UI_DISABLED;\nlet ui;\nif (isUiDisabled) {\n  ui = {\n    updateGraph: () => {}\n  };\n} else {\n  const Ui = require('./ui');\n  ui = new Ui();\n}\nconst log = (...args) => {\n  if (isUiDisabled) console.log(...args);\n};\nfunction responseTimeTracker(target, {\n  kind,\n  name\n}) {\n  if (kind !== 'method') return target;\n  return function (request, response) {\n    const reqId = randomUUID();\n    const requestStartedAt = performance.now();\n    const methodsTimeTracker = {\n      GET: performance.now(),\n      POST: performance.now()\n    };\n    // console.time('benchmark')\n    const afterExecution = target.apply(this, [request, response]);\n    const data = {\n      reqId,\n      name,\n      method: request.method,\n      url: request.url\n    };\n\n    // afterExecution.finally(_ => {\n    //   console.timeEnd('benchmark')\n    // })\n    const onFinally = onRequestEnded({\n      data,\n      response,\n      requestStartedAt,\n      methodsTimeTracker\n    });\n\n    // assuming it'll always be a promise object\n    afterExecution.finally(onFinally);\n    return afterExecution;\n  };\n}\nfunction onRequestEnded({\n  data,\n  response,\n  requestStartedAt,\n  methodsTimeTracker\n}) {\n  return () => {\n    const requestEndedAt = performance.now();\n    let timeDiff = requestEndedAt - requestStartedAt;\n    let seconds = Math.round(timeDiff);\n    data.statusCode = response.statusCode;\n    data.statusMessage = response.statusMessage;\n    data.elapsed = timeDiff.toFixed(2).concat('ms');\n    log('benchmark', data);\n    //  simulationg that we already made some calculations or spawned the process in another one\n    const trackerDiff = requestEndedAt - methodsTimeTracker[data.method];\n    if (trackerDiff >= 200) {\n      ui.updateGraph(data.method, seconds);\n      methodsTimeTracker[data.method] = performance.now();\n    }\n  };\n}\nmodule.exports = {\n  route,\n  responseTimeTracker\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyYW5kb21VVUlEIiwicmVxdWlyZSIsInJvdXRlIiwidGFyZ2V0Iiwia2luZCIsIm5hbWUiLCJyZXF1ZXN0IiwicmVzcG9uc2UiLCJzdGF0dXNDb2RlIiwibWVzc2FnZSIsImFwcGx5Iiwid3JpdGVIZWFkIiwiZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsImlzVWlEaXNhYmxlZCIsInByb2Nlc3MiLCJlbnYiLCJVSV9ESVNBQkxFRCIsInVpIiwidXBkYXRlR3JhcGgiLCJVaSIsImxvZyIsImFyZ3MiLCJjb25zb2xlIiwicmVzcG9uc2VUaW1lVHJhY2tlciIsInJlcUlkIiwicmVxdWVzdFN0YXJ0ZWRBdCIsInBlcmZvcm1hbmNlIiwibm93IiwibWV0aG9kc1RpbWVUcmFja2VyIiwiR0VUIiwiUE9TVCIsImFmdGVyRXhlY3V0aW9uIiwiZGF0YSIsIm1ldGhvZCIsInVybCIsIm9uRmluYWxseSIsIm9uUmVxdWVzdEVuZGVkIiwiZmluYWxseSIsInJlcXVlc3RFbmRlZEF0IiwidGltZURpZmYiLCJzZWNvbmRzIiwiTWF0aCIsInJvdW5kIiwic3RhdHVzTWVzc2FnZSIsImVsYXBzZWQiLCJ0b0ZpeGVkIiwiY29uY2F0IiwidHJhY2tlckRpZmYiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9tb2hpdC9EZXNrdG9wL25vZGVqcy1tb25pdG9yaW5nL3BlcmZvcm1hbmNlLW1vbml0b3Ivc3JjLyIsInNvdXJjZXMiOlsiZGVjb3JhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHtcbiAgICByYW5kb21VVUlEXG4gIH0gPSByZXF1aXJlKCdjcnlwdG8nKVxuICBcbiAgZnVuY3Rpb24gcm91dGUodGFyZ2V0LCB7XG4gICAga2luZCxcbiAgICBuYW1lXG4gIH0pIHtcbiAgICBpZiAoa2luZCAhPT0gJ21ldGhvZCcpIHJldHVybiB0YXJnZXQ7XG4gIFxuICAgIHJldHVybiBhc3luYyBmdW5jdGlvbiAocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgc3RhdHVzQ29kZSxcbiAgICAgICAgbWVzc2FnZVxuICAgICAgfSA9IGF3YWl0IHRhcmdldC5hcHBseSh0aGlzLCBbcmVxdWVzdCwgcmVzcG9uc2VdKVxuICBcbiAgICAgIHJlc3BvbnNlLndyaXRlSGVhZChzdGF0dXNDb2RlKVxuICAgICAgcmVzcG9uc2UuZW5kKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpKVxuICAgIH1cbiAgfVxuICBjb25zdCBpc1VpRGlzYWJsZWQgPSBwcm9jZXNzLmVudi5VSV9ESVNBQkxFRFxuICBsZXQgdWlcbiAgaWYgKGlzVWlEaXNhYmxlZCkge1xuICAgIHVpID0ge1xuICAgICAgdXBkYXRlR3JhcGg6ICgpID0+IHt9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IFVpID0gcmVxdWlyZSgnLi91aScpXG4gICAgdWkgPSBuZXcgVWkoKVxuICB9XG4gIFxuICBjb25zdCBsb2cgPSAoLi4uYXJncykgPT4ge1xuICAgIGlmIChpc1VpRGlzYWJsZWQpIGNvbnNvbGUubG9nKC4uLmFyZ3MpXG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHJlc3BvbnNlVGltZVRyYWNrZXIodGFyZ2V0LCB7XG4gICAga2luZCxcbiAgICBuYW1lXG4gIH0pIHtcbiAgICBpZiAoa2luZCAhPT0gJ21ldGhvZCcpIHJldHVybiB0YXJnZXQ7XG4gIFxuICAgIHJldHVybiBmdW5jdGlvbiAocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICAgIGNvbnN0IHJlcUlkID0gcmFuZG9tVVVJRCgpXG4gICAgICBjb25zdCByZXF1ZXN0U3RhcnRlZEF0ID0gcGVyZm9ybWFuY2Uubm93KClcbiAgICAgIGNvbnN0IG1ldGhvZHNUaW1lVHJhY2tlciA9IHtcbiAgICAgICAgR0VUOiBwZXJmb3JtYW5jZS5ub3coKSxcbiAgICAgICAgUE9TVDogcGVyZm9ybWFuY2Uubm93KCksXG4gICAgICB9XG4gICAgICAvLyBjb25zb2xlLnRpbWUoJ2JlbmNobWFyaycpXG4gICAgICBjb25zdCBhZnRlckV4ZWN1dGlvbiA9IHRhcmdldC5hcHBseSh0aGlzLCBbcmVxdWVzdCwgcmVzcG9uc2VdKVxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgcmVxSWQsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIG1ldGhvZDogcmVxdWVzdC5tZXRob2QsXG4gICAgICAgIHVybDogcmVxdWVzdC51cmxcbiAgICAgIH1cbiAgXG4gICAgICAvLyBhZnRlckV4ZWN1dGlvbi5maW5hbGx5KF8gPT4ge1xuICAgICAgLy8gICBjb25zb2xlLnRpbWVFbmQoJ2JlbmNobWFyaycpXG4gICAgICAvLyB9KVxuICAgICAgY29uc3Qgb25GaW5hbGx5ID0gb25SZXF1ZXN0RW5kZWQoe1xuICAgICAgICBkYXRhLFxuICAgICAgICByZXNwb25zZSxcbiAgICAgICAgcmVxdWVzdFN0YXJ0ZWRBdCxcbiAgICAgICAgbWV0aG9kc1RpbWVUcmFja2VyXG4gICAgICB9KVxuICBcbiAgICAgIC8vIGFzc3VtaW5nIGl0J2xsIGFsd2F5cyBiZSBhIHByb21pc2Ugb2JqZWN0XG4gICAgICBhZnRlckV4ZWN1dGlvbi5maW5hbGx5KG9uRmluYWxseSlcbiAgICAgIHJldHVybiBhZnRlckV4ZWN1dGlvblxuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gb25SZXF1ZXN0RW5kZWQoe1xuICAgIGRhdGEsXG4gICAgcmVzcG9uc2UsXG4gICAgcmVxdWVzdFN0YXJ0ZWRBdCxcbiAgICBtZXRob2RzVGltZVRyYWNrZXJcbiAgfSkge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0RW5kZWRBdCA9IHBlcmZvcm1hbmNlLm5vdygpXG4gICAgICBsZXQgdGltZURpZmYgPSByZXF1ZXN0RW5kZWRBdCAtIHJlcXVlc3RTdGFydGVkQXRcbiAgICAgIGxldCBzZWNvbmRzID0gTWF0aC5yb3VuZCh0aW1lRGlmZilcbiAgXG4gICAgICBkYXRhLnN0YXR1c0NvZGUgPSByZXNwb25zZS5zdGF0dXNDb2RlXG4gICAgICBkYXRhLnN0YXR1c01lc3NhZ2UgPSByZXNwb25zZS5zdGF0dXNNZXNzYWdlXG4gICAgICBkYXRhLmVsYXBzZWQgPSB0aW1lRGlmZi50b0ZpeGVkKDIpLmNvbmNhdCgnbXMnKVxuICAgICAgbG9nKCdiZW5jaG1hcmsnLCBkYXRhKVxuICAgICAgLy8gIHNpbXVsYXRpb25nIHRoYXQgd2UgYWxyZWFkeSBtYWRlIHNvbWUgY2FsY3VsYXRpb25zIG9yIHNwYXduZWQgdGhlIHByb2Nlc3MgaW4gYW5vdGhlciBvbmVcbiAgICAgIGNvbnN0IHRyYWNrZXJEaWZmID0gcmVxdWVzdEVuZGVkQXQgLSBtZXRob2RzVGltZVRyYWNrZXJbZGF0YS5tZXRob2RdXG4gICAgICBpZiAodHJhY2tlckRpZmYgPj0gMjAwKSB7XG4gIFxuICAgICAgICB1aS51cGRhdGVHcmFwaChcbiAgICAgICAgICBkYXRhLm1ldGhvZCxcbiAgICAgICAgICBzZWNvbmRzXG4gICAgICAgIClcbiAgICAgICAgbWV0aG9kc1RpbWVUcmFja2VyW2RhdGEubWV0aG9kXSA9IHBlcmZvcm1hbmNlLm5vdygpXG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICByb3V0ZSxcbiAgICByZXNwb25zZVRpbWVUcmFja2VyXG4gIH0iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFDRkE7QUFDRixDQUFDLEdBQUdDLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFFckIsU0FBU0MsS0FBS0EsQ0FBQ0MsTUFBTSxFQUFFO0VBQ3JCQyxJQUFJO0VBQ0pDO0FBQ0YsQ0FBQyxFQUFFO0VBQ0QsSUFBSUQsSUFBSSxLQUFLLFFBQVEsRUFBRSxPQUFPRCxNQUFNO0VBRXBDLE9BQU8sZ0JBQWdCRyxPQUFPLEVBQUVDLFFBQVEsRUFBRTtJQUN4QyxNQUFNO01BQ0pDLFVBQVU7TUFDVkM7SUFDRixDQUFDLEdBQUcsTUFBTU4sTUFBTSxDQUFDTyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUNKLE9BQU8sRUFBRUMsUUFBUSxDQUFDLENBQUM7SUFFakRBLFFBQVEsQ0FBQ0ksU0FBUyxDQUFDSCxVQUFVLENBQUM7SUFDOUJELFFBQVEsQ0FBQ0ssR0FBRyxDQUFDQyxJQUFJLENBQUNDLFNBQVMsQ0FBQ0wsT0FBTyxDQUFDLENBQUM7RUFDdkMsQ0FBQztBQUNIO0FBQ0EsTUFBTU0sWUFBWSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsV0FBVztBQUM1QyxJQUFJQyxFQUFFO0FBQ04sSUFBSUosWUFBWSxFQUFFO0VBQ2hCSSxFQUFFLEdBQUc7SUFDSEMsV0FBVyxFQUFFQSxDQUFBLEtBQU0sQ0FBQztFQUN0QixDQUFDO0FBQ0gsQ0FBQyxNQUFNO0VBQ0wsTUFBTUMsRUFBRSxHQUFHcEIsT0FBTyxDQUFDLE1BQU0sQ0FBQztFQUMxQmtCLEVBQUUsR0FBRyxJQUFJRSxFQUFFLENBQUMsQ0FBQztBQUNmO0FBRUEsTUFBTUMsR0FBRyxHQUFHQSxDQUFDLEdBQUdDLElBQUksS0FBSztFQUN2QixJQUFJUixZQUFZLEVBQUVTLE9BQU8sQ0FBQ0YsR0FBRyxDQUFDLEdBQUdDLElBQUksQ0FBQztBQUN4QyxDQUFDO0FBRUQsU0FBU0UsbUJBQW1CQSxDQUFDdEIsTUFBTSxFQUFFO0VBQ25DQyxJQUFJO0VBQ0pDO0FBQ0YsQ0FBQyxFQUFFO0VBQ0QsSUFBSUQsSUFBSSxLQUFLLFFBQVEsRUFBRSxPQUFPRCxNQUFNO0VBRXBDLE9BQU8sVUFBVUcsT0FBTyxFQUFFQyxRQUFRLEVBQUU7SUFDbEMsTUFBTW1CLEtBQUssR0FBRzFCLFVBQVUsQ0FBQyxDQUFDO0lBQzFCLE1BQU0yQixnQkFBZ0IsR0FBR0MsV0FBVyxDQUFDQyxHQUFHLENBQUMsQ0FBQztJQUMxQyxNQUFNQyxrQkFBa0IsR0FBRztNQUN6QkMsR0FBRyxFQUFFSCxXQUFXLENBQUNDLEdBQUcsQ0FBQyxDQUFDO01BQ3RCRyxJQUFJLEVBQUVKLFdBQVcsQ0FBQ0MsR0FBRyxDQUFDO0lBQ3hCLENBQUM7SUFDRDtJQUNBLE1BQU1JLGNBQWMsR0FBRzlCLE1BQU0sQ0FBQ08sS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDSixPQUFPLEVBQUVDLFFBQVEsQ0FBQyxDQUFDO0lBQzlELE1BQU0yQixJQUFJLEdBQUc7TUFDWFIsS0FBSztNQUNMckIsSUFBSTtNQUNKOEIsTUFBTSxFQUFFN0IsT0FBTyxDQUFDNkIsTUFBTTtNQUN0QkMsR0FBRyxFQUFFOUIsT0FBTyxDQUFDOEI7SUFDZixDQUFDOztJQUVEO0lBQ0E7SUFDQTtJQUNBLE1BQU1DLFNBQVMsR0FBR0MsY0FBYyxDQUFDO01BQy9CSixJQUFJO01BQ0ozQixRQUFRO01BQ1JvQixnQkFBZ0I7TUFDaEJHO0lBQ0YsQ0FBQyxDQUFDOztJQUVGO0lBQ0FHLGNBQWMsQ0FBQ00sT0FBTyxDQUFDRixTQUFTLENBQUM7SUFDakMsT0FBT0osY0FBYztFQUN2QixDQUFDO0FBQ0g7QUFFQSxTQUFTSyxjQUFjQSxDQUFDO0VBQ3RCSixJQUFJO0VBQ0ozQixRQUFRO0VBQ1JvQixnQkFBZ0I7RUFDaEJHO0FBQ0YsQ0FBQyxFQUFFO0VBQ0QsT0FBTyxNQUFNO0lBQ1gsTUFBTVUsY0FBYyxHQUFHWixXQUFXLENBQUNDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hDLElBQUlZLFFBQVEsR0FBR0QsY0FBYyxHQUFHYixnQkFBZ0I7SUFDaEQsSUFBSWUsT0FBTyxHQUFHQyxJQUFJLENBQUNDLEtBQUssQ0FBQ0gsUUFBUSxDQUFDO0lBRWxDUCxJQUFJLENBQUMxQixVQUFVLEdBQUdELFFBQVEsQ0FBQ0MsVUFBVTtJQUNyQzBCLElBQUksQ0FBQ1csYUFBYSxHQUFHdEMsUUFBUSxDQUFDc0MsYUFBYTtJQUMzQ1gsSUFBSSxDQUFDWSxPQUFPLEdBQUdMLFFBQVEsQ0FBQ00sT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxNQUFNLENBQUMsSUFBSSxDQUFDO0lBQy9DMUIsR0FBRyxDQUFDLFdBQVcsRUFBRVksSUFBSSxDQUFDO0lBQ3RCO0lBQ0EsTUFBTWUsV0FBVyxHQUFHVCxjQUFjLEdBQUdWLGtCQUFrQixDQUFDSSxJQUFJLENBQUNDLE1BQU0sQ0FBQztJQUNwRSxJQUFJYyxXQUFXLElBQUksR0FBRyxFQUFFO01BRXRCOUIsRUFBRSxDQUFDQyxXQUFXLENBQ1pjLElBQUksQ0FBQ0MsTUFBTSxFQUNYTyxPQUNGLENBQUM7TUFDRFosa0JBQWtCLENBQUNJLElBQUksQ0FBQ0MsTUFBTSxDQUFDLEdBQUdQLFdBQVcsQ0FBQ0MsR0FBRyxDQUFDLENBQUM7SUFDckQ7RUFDRixDQUFDO0FBQ0g7QUFFQXFCLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2ZqRCxLQUFLO0VBQ0x1QjtBQUNGLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["randomUUID","require","route","target","kind","name","request","response","statusCode","message","apply","writeHead","end","JSON","stringify","isUiDisabled","process","env","UI_DISABLED","ui","updateGraph","Ui","log","args","console","responseTimeTracker","reqId","requestStartedAt","performance","now","methodsTimeTracker","GET","POST","afterExecution","data","method","url","onFinally","onRequestEnded","finally","requestEndedAt","timeDiff","seconds","Math","round","statusMessage","elapsed","toFixed","concat","trackerDiff","module","exports"],"sourceRoot":"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/","sources":["decorator.js"],"sourcesContent":["const {\n    randomUUID\n  } = require('crypto')\n  \n  function route(target, {\n    kind,\n    name\n  }) {\n    if (kind !== 'method') return target;\n  \n    return async function (request, response) {\n      const {\n        statusCode,\n        message\n      } = await target.apply(this, [request, response])\n  \n      response.writeHead(statusCode)\n      response.end(JSON.stringify(message))\n    }\n  }\n  const isUiDisabled = process.env.UI_DISABLED\n  let ui\n  if (isUiDisabled) {\n    ui = {\n      updateGraph: () => {}\n    }\n  } else {\n    const Ui = require('./ui')\n    ui = new Ui()\n  }\n  \n  const log = (...args) => {\n    if (isUiDisabled) console.log(...args)\n  }\n  \n  function responseTimeTracker(target, {\n    kind,\n    name\n  }) {\n    if (kind !== 'method') return target;\n  \n    return function (request, response) {\n      const reqId = randomUUID()\n      const requestStartedAt = performance.now()\n      const methodsTimeTracker = {\n        GET: performance.now(),\n        POST: performance.now(),\n      }\n      // console.time('benchmark')\n      const afterExecution = target.apply(this, [request, response])\n      const data = {\n        reqId,\n        name,\n        method: request.method,\n        url: request.url\n      }\n  \n      // afterExecution.finally(_ => {\n      //   console.timeEnd('benchmark')\n      // })\n      const onFinally = onRequestEnded({\n        data,\n        response,\n        requestStartedAt,\n        methodsTimeTracker\n      })\n  \n      // assuming it'll always be a promise object\n      afterExecution.finally(onFinally)\n      return afterExecution\n    }\n  }\n  \n  function onRequestEnded({\n    data,\n    response,\n    requestStartedAt,\n    methodsTimeTracker\n  }) {\n    return () => {\n      const requestEndedAt = performance.now()\n      let timeDiff = requestEndedAt - requestStartedAt\n      let seconds = Math.round(timeDiff)\n  \n      data.statusCode = response.statusCode\n      data.statusMessage = response.statusMessage\n      data.elapsed = timeDiff.toFixed(2).concat('ms')\n      log('benchmark', data)\n      //  simulationg that we already made some calculations or spawned the process in another one\n      const trackerDiff = requestEndedAt - methodsTimeTracker[data.method]\n      if (trackerDiff >= 200) {\n  \n        ui.updateGraph(\n          data.method,\n          seconds\n        )\n        methodsTimeTracker[data.method] = performance.now()\n      }\n    }\n  }\n  \n  module.exports = {\n    route,\n    responseTimeTracker\n  }"],"mappings":"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","ignoreList":[]}},"mtime":1714913681111},"{\"assumptions\":{},\"sourceRoot\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"filename\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/ui.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/mohit/Desktop/nodejs-monitoring/performance-monitor\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-decorators\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"VariableDeclarator\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"ClassPrivateProperty\":{\"enter\":[null]},\"ClassAccessorProperty\":{\"enter\":[null]},\"ClassProperty\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"version\":\"2021-12\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]}],\"presets\":[]}:7.24.5:development":{"value":{"code":"function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nconst blessed = require('blessed');\nconst contrib = require('blessed-contrib');\nconst screen = blessed.screen();\nconst creatEmptyList = (length, val) => Array.from({\n  length\n}, _ => val);\nconst getEmptyCoordinates = () => ({\n  x: creatEmptyList(10, ' '),\n  y: creatEmptyList(10, 1)\n});\nclass Ui {\n  constructor() {\n    _defineProperty(this, \"line\", contrib.line({\n      label: 'Response Time (MS)',\n      showLegend: true,\n      xLabelPadding: 3,\n      xPadding: 5,\n      style: {\n        line: 'yellow',\n        text: 'green',\n        baseline: 'black'\n      },\n      xOffset: 0\n    }));\n    _defineProperty(this, \"getRequest\", {\n      ...getEmptyCoordinates(),\n      title: 'GET /people',\n      style: {\n        line: 'yellow'\n      }\n    });\n    _defineProperty(this, \"postRequest\", {\n      ...getEmptyCoordinates(),\n      title: 'POST /people',\n      style: {\n        line: 'green'\n      }\n    });\n    this.screen = screen;\n    this.screen.append(this.line);\n    this.renderGraph();\n  }\n  renderGraph() {\n    this.line.setData([this.getRequest, this.postRequest]);\n    this.screen.render();\n  }\n  updateGraph(method, value) {\n    const target = method === \"GET\" ? this.getRequest : this.postRequest;\n    target.y.shift();\n    target.y.push(value);\n    this.renderGraph();\n  }\n}\nmodule.exports = Ui;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJibGVzc2VkIiwicmVxdWlyZSIsImNvbnRyaWIiLCJzY3JlZW4iLCJjcmVhdEVtcHR5TGlzdCIsImxlbmd0aCIsInZhbCIsIkFycmF5IiwiZnJvbSIsIl8iLCJnZXRFbXB0eUNvb3JkaW5hdGVzIiwieCIsInkiLCJVaSIsImNvbnN0cnVjdG9yIiwiX2RlZmluZVByb3BlcnR5IiwibGluZSIsImxhYmVsIiwic2hvd0xlZ2VuZCIsInhMYWJlbFBhZGRpbmciLCJ4UGFkZGluZyIsInN0eWxlIiwidGV4dCIsImJhc2VsaW5lIiwieE9mZnNldCIsInRpdGxlIiwiYXBwZW5kIiwicmVuZGVyR3JhcGgiLCJzZXREYXRhIiwiZ2V0UmVxdWVzdCIsInBvc3RSZXF1ZXN0IiwicmVuZGVyIiwidXBkYXRlR3JhcGgiLCJtZXRob2QiLCJ2YWx1ZSIsInRhcmdldCIsInNoaWZ0IiwicHVzaCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL21vaGl0L0Rlc2t0b3Avbm9kZWpzLW1vbml0b3JpbmcvcGVyZm9ybWFuY2UtbW9uaXRvci9zcmMvIiwic291cmNlcyI6WyJ1aS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBibGVzc2VkID0gcmVxdWlyZSgnYmxlc3NlZCcpXG5jb25zdCBjb250cmliID0gcmVxdWlyZSgnYmxlc3NlZC1jb250cmliJylcbmNvbnN0IHNjcmVlbiA9IGJsZXNzZWQuc2NyZWVuKClcblxuXG5jb25zdCBjcmVhdEVtcHR5TGlzdCA9IChsZW5ndGgsIHZhbCkgPT4gQXJyYXkuZnJvbSh7XG4gIGxlbmd0aFxufSwgXyA9PiB2YWwpXG5cbmNvbnN0IGdldEVtcHR5Q29vcmRpbmF0ZXMgPSAoKSA9PiAoe1xuICB4OiBjcmVhdEVtcHR5TGlzdCgxMCwgJyAnKSxcbiAgeTogY3JlYXRFbXB0eUxpc3QoMTAsIDEpLFxufSlcbmNsYXNzIFVpIHtcbiAgbGluZSA9IGNvbnRyaWIubGluZSh7XG4gICAgbGFiZWw6ICdSZXNwb25zZSBUaW1lIChNUyknLFxuICAgIHNob3dMZWdlbmQ6IHRydWUsXG4gICAgeExhYmVsUGFkZGluZzogMyxcbiAgICB4UGFkZGluZzogNSxcbiAgICBzdHlsZToge1xuICAgICAgbGluZTogJ3llbGxvdycsXG4gICAgICB0ZXh0OiAnZ3JlZW4nLFxuICAgICAgYmFzZWxpbmU6ICdibGFjaycsXG4gICAgfSxcbiAgICB4T2Zmc2V0OiAwLFxuICB9KVxuICBnZXRSZXF1ZXN0ID0ge1xuICAgIC4uLmdldEVtcHR5Q29vcmRpbmF0ZXMoKSxcbiAgICB0aXRsZTogJ0dFVCAvcGVvcGxlJyxcbiAgICBzdHlsZToge1xuICAgICAgbGluZTogJ3llbGxvdycsXG4gICAgfVxuICB9XG4gIFxuICBwb3N0UmVxdWVzdCA9IHtcbiAgICAuLi5nZXRFbXB0eUNvb3JkaW5hdGVzKCksXG4gICAgdGl0bGU6ICdQT1NUIC9wZW9wbGUnLFxuICAgIHN0eWxlOiB7XG4gICAgICBsaW5lOiAnZ3JlZW4nXG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zY3JlZW4gPSBzY3JlZW5cbiAgICB0aGlzLnNjcmVlbi5hcHBlbmQodGhpcy5saW5lKVxuICAgIHRoaXMucmVuZGVyR3JhcGgoKVxuICB9XG5cbiAgcmVuZGVyR3JhcGgoKSB7XG4gICAgdGhpcy5saW5lLnNldERhdGEoW1xuICAgICAgdGhpcy5nZXRSZXF1ZXN0LFxuICAgICAgdGhpcy5wb3N0UmVxdWVzdCxcbiAgICBdKVxuXG4gICAgdGhpcy5zY3JlZW4ucmVuZGVyKClcbiAgfVxuICB1cGRhdGVHcmFwaChtZXRob2QsIHZhbHVlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gbWV0aG9kICA9PT0gXCJHRVRcIiA/XG4gICAgICB0aGlzLmdldFJlcXVlc3QgOlxuICAgICAgdGhpcy5wb3N0UmVxdWVzdFxuXG4gICAgdGFyZ2V0Lnkuc2hpZnQoKVxuICAgIHRhcmdldC55LnB1c2godmFsdWUpXG5cbiAgICB0aGlzLnJlbmRlckdyYXBoKClcbiAgfVxufVxuXG5c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","map":{"version":3,"names":["blessed","require","contrib","screen","creatEmptyList","length","val","Array","from","_","getEmptyCoordinates","x","y","Ui","constructor","_defineProperty","line","label","showLegend","xLabelPadding","xPadding","style","text","baseline","xOffset","title","append","renderGraph","setData","getRequest","postRequest","render","updateGraph","method","value","target","shift","push","module","exports"],"sourceRoot":"/home/mohit/Desktop/nodejs-monitoring/performance-monitor/src/","sources":["ui.js"],"sourcesContent":["const blessed = require('blessed')\nconst contrib = require('blessed-contrib')\nconst screen = blessed.screen()\n\n\nconst creatEmptyList = (length, val) => Array.from({\n  length\n}, _ => val)\n\nconst getEmptyCoordinates = () => ({\n  x: creatEmptyList(10, ' '),\n  y: creatEmptyList(10, 1),\n})\nclass Ui {\n  line = contrib.line({\n    label: 'Response Time (MS)',\n    showLegend: true,\n    xLabelPadding: 3,\n    xPadding: 5,\n    style: {\n      line: 'yellow',\n      text: 'green',\n      baseline: 'black',\n    },\n    xOffset: 0,\n  })\n  getRequest = {\n    ...getEmptyCoordinates(),\n    title: 'GET /people',\n    style: {\n      line: 'yellow',\n    }\n  }\n  \n  postRequest = {\n    ...getEmptyCoordinates(),\n    title: 'POST /people',\n    style: {\n      line: 'green'\n    }\n  }\n\n  constructor() {\n    this.screen = screen\n    this.screen.append(this.line)\n    this.renderGraph()\n  }\n\n  renderGraph() {\n    this.line.setData([\n      this.getRequest,\n      this.postRequest,\n    ])\n\n    this.screen.render()\n  }\n  updateGraph(method, value) {\n    const target = method  === \"GET\" ?\n      this.getRequest :\n      this.postRequest\n\n    target.y.shift()\n    target.y.push(value)\n\n    this.renderGraph()\n  }\n}\n\n\nmodule.exports = Ui"],"mappings":";;;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,OAAO,GAAGD,OAAO,CAAC,iBAAiB,CAAC;AAC1C,MAAME,MAAM,GAAGH,OAAO,CAACG,MAAM,CAAC,CAAC;AAG/B,MAAMC,cAAc,GAAGA,CAACC,MAAM,EAAEC,GAAG,KAAKC,KAAK,CAACC,IAAI,CAAC;EACjDH;AACF,CAAC,EAAEI,CAAC,IAAIH,GAAG,CAAC;AAEZ,MAAMI,mBAAmB,GAAGA,CAAA,MAAO;EACjCC,CAAC,EAAEP,cAAc,CAAC,EAAE,EAAE,GAAG,CAAC;EAC1BQ,CAAC,EAAER,cAAc,CAAC,EAAE,EAAE,CAAC;AACzB,CAAC,CAAC;AACF,MAAMS,EAAE,CAAC;EA6BPC,WAAWA,CAAA,EAAG;IAAAC,eAAA,eA5BPb,OAAO,CAACc,IAAI,CAAC;MAClBC,KAAK,EAAE,oBAAoB;MAC3BC,UAAU,EAAE,IAAI;MAChBC,aAAa,EAAE,CAAC;MAChBC,QAAQ,EAAE,CAAC;MACXC,KAAK,EAAE;QACLL,IAAI,EAAE,QAAQ;QACdM,IAAI,EAAE,OAAO;QACbC,QAAQ,EAAE;MACZ,CAAC;MACDC,OAAO,EAAE;IACX,CAAC,CAAC;IAAAT,eAAA,qBACW;MACX,GAAGL,mBAAmB,CAAC,CAAC;MACxBe,KAAK,EAAE,aAAa;MACpBJ,KAAK,EAAE;QACLL,IAAI,EAAE;MACR;IACF,CAAC;IAAAD,eAAA,sBAEa;MACZ,GAAGL,mBAAmB,CAAC,CAAC;MACxBe,KAAK,EAAE,cAAc;MACrBJ,KAAK,EAAE;QACLL,IAAI,EAAE;MACR;IACF,CAAC;IAGC,IAAI,CAACb,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACA,MAAM,CAACuB,MAAM,CAAC,IAAI,CAACV,IAAI,CAAC;IAC7B,IAAI,CAACW,WAAW,CAAC,CAAC;EACpB;EAEAA,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACX,IAAI,CAACY,OAAO,CAAC,CAChB,IAAI,CAACC,UAAU,EACf,IAAI,CAACC,WAAW,CACjB,CAAC;IAEF,IAAI,CAAC3B,MAAM,CAAC4B,MAAM,CAAC,CAAC;EACtB;EACAC,WAAWA,CAACC,MAAM,EAAEC,KAAK,EAAE;IACzB,MAAMC,MAAM,GAAGF,MAAM,KAAM,KAAK,GAC9B,IAAI,CAACJ,UAAU,GACf,IAAI,CAACC,WAAW;IAElBK,MAAM,CAACvB,CAAC,CAACwB,KAAK,CAAC,CAAC;IAChBD,MAAM,CAACvB,CAAC,CAACyB,IAAI,CAACH,KAAK,CAAC;IAEpB,IAAI,CAACP,WAAW,CAAC,CAAC;EACpB;AACF;AAGAW,MAAM,CAACC,OAAO,GAAG1B,EAAE","ignoreList":[]}},"mtime":1714914404324}}